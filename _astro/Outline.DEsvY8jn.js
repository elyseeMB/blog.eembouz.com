import{_ as V}from"./preload-helper.BlTxHScW.js";import{y as x,A as P,d as k}from"./hooks.module.WNmjjaza.js";import{x as g,l as _,_ as A,k as O,H as w}from"./preact.module.D9mvYqus.js";import{u as m}from"./jsxRuntime.module.DyQSt29u.js";function W(e,t){for(var r in t)e[r]=t[r];return e}function C(e,t){for(var r in e)if(r!=="__source"&&!(r in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function N(e,t){this.props=e,this.context=t}(N.prototype=new g).isPureReactComponent=!0,N.prototype.shouldComponentUpdate=function(e,t){return C(this.props,e)||C(this.state,t)};var S=_.__b;_.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),S&&S(e)};var D=_.__e;_.__e=function(e,t,r,n){if(e.then){for(var o,i=t;i=i.__;)if((o=i.__c)&&o.__c)return t.__e==null&&(t.__e=r.__e,t.__k=r.__k),o.__c(e,t)}D(e,t,r,n)};var I=_.unmount;function z(e,t,r){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=W({},e)).__c!=null&&(e.__c.__P===r&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return z(n,t,r)})),e}function B(e,t,r){return e&&r&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return B(n,t,r)}),e.__c&&e.__c.__P===t&&(e.__e&&r.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=r)),e}function E(){this.__u=0,this.o=null,this.__b=null}function M(e){if(!e.__)return null;var t=e.__.__c;return t&&t.__a&&t.__a(e)}function b(){this.i=null,this.l=null}_.unmount=function(e){var t=e.__c;t&&(t.__z=!0),t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),I&&I(e)},(E.prototype=new g).__c=function(e,t){var r=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(r);var o=M(n.__v),i=!1,a=function(){i||n.__z||(i=!0,r.__R=null,o?o(c):c())};r.__R=a;var u=r.__P;r.__P=null;var c=function(){if(!--n.__u){if(n.state.__a){var f=n.state.__a;n.__v.__k[0]=B(f,f.__c.__P,f.__c.__O)}var l;for(n.setState({__a:n.__b=null});l=n.o.pop();)l.__P=u,l.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(a,a)},E.prototype.componentWillUnmount=function(){this.o=[]},E.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=z(this.__b,r,n.__O=n.__P)}this.__b=null}var o=t.__a&&A(O,null,e.fallback);return o&&(o.__u&=-33),[A(O,null,t.__a?null:e.children),o]};var H=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(b.prototype=new g).__a=function(e){var t=this,r=M(t.__v),n=t.l.get(e);return n[0]++,function(o){var i=function(){t.props.revealOrder?(n.push(o),H(t,e,n)):o()};r?r(i):i()}},b.prototype.render=function(e){this.i=null,this.l=new Map;var t=w(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},b.prototype.componentDidUpdate=b.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,r){H(e,r,t)})};var j=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,$=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,q=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,F=/[A-Z0-9]/g,Z=typeof document<"u",G=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};g.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(g.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var R=_.event;function J(){}function K(){return this.cancelBubble}function Q(){return this.defaultPrevented}_.event=function(e){return R&&(e=R(e)),e.persist=J,e.isPropagationStopped=K,e.isDefaultPrevented=Q,e.nativeEvent=e};var X={enumerable:!1,configurable:!0,get:function(){return this.class}},L=_.vnode;_.vnode=function(e){typeof e.type=="string"&&(function(t){var r=t.props,n=t.type,o={},i=n.indexOf("-")===-1;for(var a in r){var u=r[a];if(!(a==="value"&&"defaultValue"in r&&u==null||Z&&a==="children"&&n==="noscript"||a==="class"||a==="className")){var c=a.toLowerCase();a==="defaultValue"&&"value"in r&&r.value==null?a="value":a==="download"&&u===!0?u="":c==="translate"&&u==="no"?u=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?a="ondblclick":c!=="onchange"||n!=="input"&&n!=="textarea"||G(r.type)?c==="onfocus"?a="onfocusin":c==="onblur"?a="onfocusout":q.test(a)&&(a=c):c=a="oninput":i&&$.test(a)?a=a.replace(F,"-$&").toLowerCase():u===null&&(u=void 0),c==="oninput"&&o[a=c]&&(a="oninputCapture"),o[a]=u}}n=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=w(r.children).forEach(function(f){f.props.selected=o.value.indexOf(f.props.value)!=-1})),n=="select"&&o.defaultValue!=null&&(o.value=w(r.children).forEach(function(f){f.props.selected=o.multiple?o.defaultValue.indexOf(f.props.value)!=-1:o.defaultValue==f.props.value})),r.class&&!r.className?(o.class=r.class,Object.defineProperty(o,"className",X)):(r.className&&!r.class||r.class&&r.className)&&(o.class=o.className=r.className),t.props=o})(e),e.$$typeof=j,L&&L(e)};var U=_.__r;_.__r=function(e){U&&U(e),e.__c};var T=_.diffed;_.diffed=function(e){T&&T(e);var t=e.props,r=e.__e;r!=null&&e.type==="textarea"&&"value"in t&&t.value!==r.value&&(r.value=t.value==null?"":t.value)};function Y(e,t){return x(()=>{const r=e();return()=>r.then(n=>n?.())},[t])}function oe(){const e=P(null),[t,r]=k(!1),[n,o]=k(null),[i,a]=k({}),u=P(null);x(()=>{const l=Array.from(document.querySelectorAll("h2")),d=Array.from(document.querySelectorAll("h3"));a(s=>({...s,heading_level_2:l,heading_level_3:d}));const p=[];return l.forEach(s=>{const v=new IntersectionObserver(h=>{const y=h[0];y.isIntersecting&&o(y.target)},{rootMargin:"-10px 0px -90% 0px"});v.observe(s),p.push(v)}),()=>{p.forEach(s=>{s.disconnect()})}},[]),Y(async()=>{if(!u.current)return;const{ChapiterAnimation:l}=await V(async()=>{const{ChapiterAnimation:p}=await import("./ChapiterAnimation.BnILsjXg.js");return{ChapiterAnimation:p}},[]),d=new l(u.current);return()=>{d.destroy()}},[i,t]),x(()=>{const l=s=>{const v=[];let h=s.nextElementSibling;for(;h&&h.tagName!=="H2";)h.tagName==="P"&&v.push(h),h=h.nextElementSibling;return v},d=document.getElementById("mindmap"),p=s=>{if(!s.target)return;const v=document.getElementById(s.target.dataset.target);if(!v)return;const h=new Map(Array.from({length:2},()=>[v,l(v)]));h&&h.get(v)?.forEach(y=>{console.log(y)})};return d?.addEventListener("mindmap",p),()=>d?.removeEventListener("mindmap",p)},[]);const c=l=>{l.preventDefault();const p=l.currentTarget.firstElementChild.getAttribute("href")?.replace("#","");if(p){const s=document.getElementById(p);if(s){const v=s.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:v-50,behavior:"smooth"})}}};x(()=>{if(!t)return;const l=d=>{e.current&&e.current.contains(d.target)||d.target.closest(".magnetic")||r(!1)};return document.addEventListener("click",l),()=>{document.removeEventListener("click",l)}},[t]);const f=()=>r(!0);return m("div",{class:"relative w-max hidden md:block lg:block",children:[m("div",{class:"fixed inset-y-0 right-0 z-40 w-10 ",onMouseEnter:f}),m("div",{class:"fixed top-[40%] z-50 right-5 pointer-events-none",children:[m("div",{"data-strength":"45","data-strength-text":"25",class:"magnetic pointer-events-auto",onMouseEnter:f,children:m("div",{class:"relative flex flex-col items-center rounded-lg gap-3 p-3 hover:bg-[var(--secondary)]/30",children:Array.from({length:i.heading_level_2?.length??0},(l,d)=>{const p=i.heading_level_2?.findIndex(s=>s.id===n?.id)??-1;return m("div",{style:{backgroundColor:p===d?"var(--color-primary)":"var(--secondary)"},class:"w-5 h-0.5 block"})})})}),t&&m("div",{ref:e,className:"absolute top-1/2 -translate-y-1/2 right-[calc(100%+1rem)] z-60 w-max max-h-[calc(100vh-4rem)] rounded-lg overflow-y-auto border border-[var(--secondary)] bg-[var(--secondary)] dark:bg-[var(--background)] p-[1rem] animate-slide-x-in pointer-events-auto",children:m("ul",{ref:u,id:"chapiter-animation",className:"flex flex-col",children:i.heading_level_2?.map((l,d)=>m("li",{onClick:c,className:"flex items-center cursor-pointer text-[var(--color-secondary)]/60",children:m("a",{class:"relative p-2",href:"#"+l.id,children:m("div",{style:{color:n?.id===l.id?"var(--color-primary)":"inherit"},class:"block max-w-[200px] overflow-hidden text-ellipsis transition",children:l.textContent?.replace(/[^\p{L}\p{N}\s]/gu,"").trim()})},l.id)}))})})]})]})}export{oe as Outline};
