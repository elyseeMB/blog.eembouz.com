import{x as g,l as s,_ as P,k as A,H as w,a as V}from"./preact.module.ohYcs8VR.js";import{y as x,A as O,d as k}from"./hooks.module.Birv3DAJ.js";function W(e,t){for(var r in t)e[r]=t[r];return e}function C(e,t){for(var r in e)if(r!=="__source"&&!(r in t))return!0;for(var n in t)if(n!=="__source"&&e[n]!==t[n])return!0;return!1}function N(e,t){this.props=e,this.context=t}(N.prototype=new g).isPureReactComponent=!0,N.prototype.shouldComponentUpdate=function(e,t){return C(this.props,e)||C(this.state,t)};var S=s.__b;s.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),S&&S(e)};var D=s.__e;s.__e=function(e,t,r,n){if(e.then){for(var o,_=t;_=_.__;)if((o=_.__c)&&o.__c)return t.__e==null&&(t.__e=r.__e,t.__k=r.__k),o.__c(e,t)}D(e,t,r,n)};var I=s.unmount;function z(e,t,r){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),e.__c.__H=null),(e=W({},e)).__c!=null&&(e.__c.__P===r&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(n){return z(n,t,r)})),e}function B(e,t,r){return e&&r&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(n){return B(n,t,r)}),e.__c&&e.__c.__P===t&&(e.__e&&r.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=r)),e}function E(){this.__u=0,this.o=null,this.__b=null}function M(e){if(!e.__)return null;var t=e.__.__c;return t&&t.__a&&t.__a(e)}function b(){this.i=null,this.l=null}s.unmount=function(e){var t=e.__c;t&&(t.__z=!0),t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),I&&I(e)},(E.prototype=new g).__c=function(e,t){var r=t.__c,n=this;n.o==null&&(n.o=[]),n.o.push(r);var o=M(n.__v),_=!1,l=function(){_||n.__z||(_=!0,r.__R=null,o?o(i):i())};r.__R=l;var a=r.__P;r.__P=null;var i=function(){if(!--n.__u){if(n.state.__a){var u=n.state.__a;n.__v.__k[0]=B(u,u.__c.__P,u.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.o.pop();)c.__P=a,c.forceUpdate()}};n.__u++||32&t.__u||n.setState({__a:n.__b=n.__v.__k[0]}),e.then(l,l)},E.prototype.componentWillUnmount=function(){this.o=[]},E.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var r=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=z(this.__b,r,n.__O=n.__P)}this.__b=null}var o=t.__a&&P(A,null,e.fallback);return o&&(o.__u&=-33),[P(A,null,t.__a?null:e.children),o]};var H=function(e,t,r){if(++r[1]===r[0]&&e.l.delete(t),e.props.revealOrder&&(e.props.revealOrder[0]!=="t"||!e.l.size))for(r=e.i;r;){for(;r.length>3;)r.pop()();if(r[1]<r[0])break;e.i=r=r[2]}};(b.prototype=new g).__a=function(e){var t=this,r=M(t.__v),n=t.l.get(e);return n[0]++,function(o){var _=function(){t.props.revealOrder?(n.push(o),H(t,e,n)):o()};r?r(_):_()}},b.prototype.render=function(e){this.i=null,this.l=new Map;var t=w(e.children);e.revealOrder&&e.revealOrder[0]==="b"&&t.reverse();for(var r=t.length;r--;)this.l.set(t[r],this.i=[1,0,this.i]);return e.children},b.prototype.componentDidUpdate=b.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,r){H(e,r,t)})};var $=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,j=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,q=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,F=/[A-Z0-9]/g,Z=typeof document<"u",G=function(e){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(e)};g.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(g.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var R=s.event;function J(){}function K(){return this.cancelBubble}function Q(){return this.defaultPrevented}s.event=function(e){return R&&(e=R(e)),e.persist=J,e.isPropagationStopped=K,e.isDefaultPrevented=Q,e.nativeEvent=e};var X={enumerable:!1,configurable:!0,get:function(){return this.class}},L=s.vnode;s.vnode=function(e){typeof e.type=="string"&&(function(t){var r=t.props,n=t.type,o={},_=n.indexOf("-")===-1;for(var l in r){var a=r[l];if(!(l==="value"&&"defaultValue"in r&&a==null||Z&&l==="children"&&n==="noscript"||l==="class"||l==="className")){var i=l.toLowerCase();l==="defaultValue"&&"value"in r&&r.value==null?l="value":l==="download"&&a===!0?a="":i==="translate"&&a==="no"?a=!1:i[0]==="o"&&i[1]==="n"?i==="ondoubleclick"?l="ondblclick":i!=="onchange"||n!=="input"&&n!=="textarea"||G(r.type)?i==="onfocus"?l="onfocusin":i==="onblur"?l="onfocusout":q.test(l)&&(l=i):i=l="oninput":_&&j.test(l)?l=l.replace(F,"-$&").toLowerCase():a===null&&(a=void 0),i==="oninput"&&o[l=i]&&(l="oninputCapture"),o[l]=a}}n=="select"&&o.multiple&&Array.isArray(o.value)&&(o.value=w(r.children).forEach(function(u){u.props.selected=o.value.indexOf(u.props.value)!=-1})),n=="select"&&o.defaultValue!=null&&(o.value=w(r.children).forEach(function(u){u.props.selected=o.multiple?o.defaultValue.indexOf(u.props.value)!=-1:o.defaultValue==u.props.value})),r.class&&!r.className?(o.class=r.class,Object.defineProperty(o,"className",X)):(r.className&&!r.class||r.class&&r.className)&&(o.class=o.className=r.className),t.props=o})(e),e.$$typeof=$,L&&L(e)};var U=s.__r;s.__r=function(e){U&&U(e),e.__c};var T=s.diffed;s.diffed=function(e){T&&T(e);var t=e.props,r=e.__e;r!=null&&e.type==="textarea"&&"value"in t&&t.value!==r.value&&(r.value=t.value==null?"":t.value)};function Y(e,t){return x(()=>{const r=e();return()=>r.then(n=>n?.())},[t])}var ee=0;function m(e,t,r,n,o,_){t||(t={});var l,a,i=t;if("ref"in i)for(a in i={},t)a=="ref"?l=t[a]:i[a]=t[a];var u={type:e,props:i,key:r,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ee,__i:-1,__u:0,__source:o,__self:_};if(typeof e=="function"&&(l=e.defaultProps))for(a in l)i[a]===void 0&&(i[a]=l[a]);return s.vnode&&s.vnode(u),u}function ne(){const e=O(null),[t,r]=k(!1),[n,o]=k(null),[_,l]=k({}),a=O(null);x(()=>{const c=Array.from(document.querySelectorAll("h2")),d=Array.from(document.querySelectorAll("h3"));l(f=>({...f,heading_level_2:c,heading_level_3:d}));const p=[];return c.forEach(f=>{const v=new IntersectionObserver(h=>{const y=h[0];y.isIntersecting&&o(y.target)},{rootMargin:"-10px 0px -90% 0px"});v.observe(f),p.push(v)}),()=>{p.forEach(f=>{f.disconnect()})}},[]),Y(async()=>{if(!a.current)return;const{ChapiterAnimation:c}=await V(async()=>{const{ChapiterAnimation:p}=await import("./ChapiterAnimation.BnILsjXg.js");return{ChapiterAnimation:p}},[]),d=new c(a.current);return()=>{d.destroy()}},[_,t]),x(()=>{const c=f=>{const v=[];let h=f.nextElementSibling;for(;h&&h.tagName!=="H2";)h.tagName==="P"&&v.push(h),h=h.nextElementSibling;return v},d=document.getElementById("mindmap"),p=f=>{if(!f.target)return;const v=document.getElementById(f.target.dataset.target);if(!v)return;const h=new Map(Array.from({length:2},()=>[v,c(v)]));h&&h.get(v)?.forEach(y=>{console.log(y)})};return d?.addEventListener("mindmap",p),()=>d?.removeEventListener("mindmap",p)},[]);const i=c=>{c.preventDefault();const p=c.currentTarget.firstElementChild.getAttribute("href")?.replace("#","");if(p){const f=document.getElementById(p);if(f){const v=f.getBoundingClientRect().top+window.scrollY;window.scrollTo({top:v-50,behavior:"smooth"})}}};x(()=>{if(!t)return;const c=d=>{e.current&&e.current.contains(d.target)||d.target.closest(".magnetic")||r(!1)};return document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[t]);const u=()=>r(!0);return m("div",{class:"relative w-max hidden md:block lg:block",children:[m("div",{class:"fixed inset-y-0 right-0 z-40 w-10 ",onMouseEnter:u}),m("div",{class:"fixed top-[40%] z-50 right-5 pointer-events-none",children:[m("div",{"data-strength":"45","data-strength-text":"25",class:"magnetic pointer-events-auto",onMouseEnter:u,children:m("div",{class:"relative flex flex-col items-center rounded-lg gap-3 p-3 hover:bg-[var(--secondary)]/30",children:Array.from({length:_.heading_level_2?.length??0},(c,d)=>{const p=_.heading_level_2?.findIndex(f=>f.id===n?.id)??-1;return m("div",{style:{backgroundColor:p===d?"var(--color-primary)":"var(--secondary)"},class:"w-5 h-0.5 block"})})})}),t&&m("div",{ref:e,className:"absolute top-1/2 -translate-y-1/2 right-[calc(100%+1rem)] z-60 w-max max-h-[calc(100vh-4rem)] rounded-lg overflow-y-auto border border-[var(--secondary)] bg-[var(--secondary)] dark:bg-[var(--background)] p-[1rem] animate-slide-x-in pointer-events-auto",children:m("ul",{ref:a,id:"chapiter-animation",className:"flex flex-col",children:_.heading_level_2?.map((c,d)=>m("li",{onClick:i,className:"flex items-center cursor-pointer text-[var(--color-secondary)]/60",children:m("a",{class:"relative p-2",href:"#"+c.id,children:m("div",{style:{color:n?.id===c.id?"var(--color-primary)":"inherit"},class:"block max-w-[200px] overflow-hidden text-ellipsis transition",children:c.textContent?.replace(/[^\p{L}\p{N}\s]/gu,"").trim()})},c.id)}))})})]})]})}export{ne as Outline};
